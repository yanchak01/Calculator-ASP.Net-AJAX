@using Calculator.DTO;
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width" />
        <title>Calculator</title>
        <link href="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
        <link href="~/css/pageStyles.css" rel="stylesheet" />

    </head>
<body>>
<div>  
    <table class="my-table" id="results">
        <thead><tr>
            <th></th>
            <th></th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>
    
<div>
    <form class="my-form" id="calculatorForm" name="calculatorForm">
        <input type="hidden" name="id" value="0" />
        <input class="form-control" size="50" id="Text" name="Text" />
        <table id="buttons-table">
            <tr>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('(')">(</button></td>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression(')')">)</button></td>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('^')">^</button></td>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('?')">?</button></td>
            </tr>
            <tr>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('9')">9</button></td>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('8')">8</button></td>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('7')">7</button></td>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('+')">+</button></td>
            </tr>
            <tr>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('6')">6</button></td>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('5')">5</button></td>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('4')">4</button></td>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('-')">-</button></td>
            </tr>
            <tr>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('3')">3</button></td>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('2')">2</button></td>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('1')">1</button></td>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('/')">/</button></td>
            </tr>
            <tr>
                <td><button type="submit" class="numbers-buttons">=</button></td>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('.')">.</button></td>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('0')">0</button></td>
                <td><button type="button" class="numbers-buttons" onclick="addToExpression('*')">*</button></td>
            </tr>
        </table>
    </form>
</div>
    <script>
        
function addToExpression(item) {
    var form = document.forms["calculatorForm"];
    var b = form.elements["Text"].value;
    var temp = new Array(b);
    var numbers = temp.join("");

    if (numbers.length == 0 && !isDigit(item)) {
        form.elements["Text"].value += "";
        return;
    }
    if (isDigit(item) && numbers[numbers.length - 1] == "0") {
        if (isDigit(numbers[numbers.length - 2]) || numbers[numbers.length - 2] == ".") {
            form.elements["Text"].value += item;
            return;
        }
        else {
            form.elements["Text"].value += "";
            return;
        }
    }
    if (item == numbers[numbers.length - 1] && !isDigit(item)) {
        form.elements["Text"].value += "";
    }
    else {
        form.elements["Text"].value += item;
    }
};

function isDigit(item) {
    if (item >= 0 && item <= 9) {
        return true;
    }
    else
        return false;
}

function GetAllResults(){
    $.ajax({
        url: '/Home/GetAll',
        type: 'GET',
        contentType: "aplication/json",
        success: function (results) {
            var rows = "";
            results = document.
            $.each(results, function (index,result) {
                rows += row(result);
            })

            $("table tbody").append(rows);
        }
    });
}

var row = function (result) {
    return "<tr><td>" + result.Text + "</td></tr>";
};

function CreateExample(text) {
    $.ajax({
        url: '/Home/Insert',
        method: "POST",
        contentType: "application/json",
        data: JSON.stringify({
            Text: text
        }),
        success: function (example) {
            clearForm();
            resulrWriter(example.Text);
            $("table tbody").append(row(result));    
        }
    });
}

function clearForm() {
    var form = document.forms["calculatorForm"];
    form.reset();
}

function resulrWriter(text) {
    var form = document.forms["calculatorForm"];
    form.elements["Text"].value = text
}

$("form").submit(function (e) {
    e.preventDefault();
    $('#errors').empty();
    $('#errors').hide();
    var id = this.elements["id"].value;
    var Text = this.elements["Text"].value;
    if (id == 0)
        CreateExample(Text);
    else {
        id == null;
        CreateExample(Text);
    }
});
        GetAllResults();
    </script>
</body>
